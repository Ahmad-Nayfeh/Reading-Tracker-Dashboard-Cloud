# 🏃‍♂️ ماراثون القراءة (النسخة المحلية - SQLite)

<div dir="rtl">

[![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python)](https://www.python.org/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.25%2B-red?logo=streamlit)](https.streamlit.io/)
[![SQLite](https://img.shields.io/badge/Database-SQLite-blue.svg)](https://www.sqlite.org/)

-----

### 🛑 **ملاحظة هامة جداً: هذا المستودع مؤرشف**

هذا المستودع يحتوي على النسخة **الأولى** من المشروع، والتي تعتمد على قاعدة بيانات محلية (`SQLite`). هذه النسخة مثالية للتشغيل على جهازك الشخصي لأغراض التجربة والتطوير.

**التطوير الفعلي والمستقبلي للمشروع قد انتقل إلى مستودع جديد يعتمد على بنية سحابية بالكامل (`Firebase Firestore`) ليدعم الاستخدام الجماعي والنشر على الإنترنت.**

**للحصول على أحدث نسخة من المشروع، يرجى زيارة المستودع الجديد:**

### 🔗 **[Reading-Tracker-Dashboard-Cloud](https://github.com/Ahmad-Nayfeh/Reading-Tracker-Dashboard-Cloud)**

-----

## 🎯 عن المشروع

**ماراثون القراءة** هي منصة تفاعلية مصممة لإدارة وتنظيم سباقات القراءة بين الأصدقاء والمجموعات. يقوم التطبيق بسحب بيانات القراءة المسجلة عبر Google Forms، ومن ثم يعالجها ويحللها لعرض إحصائيات غنية ورسوم بيانية جذابة، بالإضافة إلى إنشاء تقارير PDF مخصصة باللغة العربية.

## ✨ الميزات الرئيسية

  - **لوحة تحكم شاملة:** عرض إحصائيات عامة لجميع المشاركين والتحديات.
  - **تحليلات مخصصة:** صفحات خاصة بكل ماراثون لعرض تفاصيله ونتائج المتسابقين فيه.
  - **تكامل مع خدمات جوجل:** ربط آمن مع حساب جوجل لسحب البيانات من Google Sheets.
  - **توليد تقارير PDF:** إنشاء تقارير احترافية ومنسقة تدعم اللغة العربية بشكل كامل.
  - **إدارة المستخدمين والتحديات:** واجهة بسيطة لإدارة بيانات المتسابقين، الكتب، وتفاصيل الماراثونات.
  - **قاعدة بيانات محلية:** يعمل بشكل كامل على جهازك دون الحاجة لأي إعدادات سحابية معقدة.

## 🛠️ التقنيات المستخدمة

  - **لغة البرمجة:** Python
  - **واجهة المستخدم:** Streamlit
  - **معالجة البيانات:** Pandas
  - **الرسوم البيانية:** Plotly
  - **قاعدة البيانات:** SQLite
  - **الربط مع جوجل:** gspread & Google OAuth
  - **تقارير PDF:** FPDF2

-----

## 🚀 دليل الإعداد والتشغيل

لتشغيل هذا المشروع على جهازك المحلي، اتبع الخطوات التالية بالتفصيل:

### الخطوة 1: استنساخ المستودع

افتح الطرفية (Terminal) وقم بنسخ المستودع إلى جهازك باستخدام الأمر التالي:

```bash
git clone https://github.com/Ahmad-Nayfeh/Reading-Tracker-Dashboard.git
cd Reading-Tracker-Dashboard
```

### الخطوة 2: إعداد مشروع Google Cloud والحصول على الصلاحيات

هذا التطبيق يحتاج إلى صلاحيات لقراءة البيانات من Google Sheets.

1.  اذهب إلى [Google Cloud Console](https://console.cloud.google.com/).
2.  أنشئ مشروعًا جديدًا (New Project).
3.  من القائمة الجانبية، اذهب إلى `APIs & Services > Library`.
4.  ابحث عن وتمكين الـ APIs التالية:
      * **Google Drive API**
      * **Google Sheets API**
5.  الآن، اذهب إلى `APIs & Services > OAuth consent screen`:
      * اختر `External` ثم `Create`.
      * املأ البيانات المطلوبة (اسم التطبيق، إيميل الدعم).
      * في صفحة `Scopes`، لا تقم بإضافة أي شيء واضغط `Save and Continue`.
      * في صفحة `Test users`، أضف حساب جوجل الخاص بك الذي ستسجل الدخول به.
6.  أخيرًا، اذهب إلى `APIs & Services > Credentials`:
      * اضغط على `+ CREATE CREDENTIALS` واختر `OAuth client ID`.
      * اختر `Desktop app` كنوع للتطبيق.
      * بعد الإنشاء، اضغط على أيقونة التنزيل للحصول على ملف الصلاحيات. **سيتم تنزيل ملف باسم `client_secret_....json`.**

### الخطوة 3: تجهيز بيئة العمل وتثبيت الحزم

نوصي بشدة باستخدام بيئة افتراضية (virtual environment) للحفاظ على نظافة حزم بايثون.

```bash
# إنشاء بيئة افتراضية
python -m venv venv

# تفعيل البيئة على (macOS/Linux)
source venv/bin/activate

# تفعيل البيئة على (Windows)
.\venv\Scripts\activate

# تثبيت جميع المكتبات المطلوبة
pip install -r requirements.txt
```

### الخطوة 4: وضع ملف الصلاحيات في المشروع

  - قم بإعادة تسمية ملف `client_secret_....json` الذي قمت بتنزيله إلى `client_secret.json` فقط.
  - **ضع هذا الملف في المجلد الرئيسي للمشروع** (نفس المكان الذي يوجد به ملف `app.py`).

### الخطوة 5: تهيئة قاعدة البيانات

قبل تشغيل التطبيق لأول مرة، يجب عليك إنشاء قاعدة البيانات والجداول الخاصة بها. قم بتشغيل السكربت التالي مرة واحدة فقط:

```bash
python database_setup.py
```

سيؤدي هذا الأمر إلى إنشاء ملف جديد باسم `reading_tracker.db` في المجلد `data`.

### الخطوة 6: تشغيل التطبيق

أنت الآن جاهز تمامًا\! قم بتشغيل التطبيق باستخدام الأمر التالي:

```bash
streamlit run app.py
```

سيفتح التطبيق تلقائيًا في متصفحك. عند أول تشغيل، سيطلب منك الربط مع حساب جوجل الذي أضفته كـ "Test User".

-----

## 📂 بنية المشروع

```
.
├── 📄 .gitignore           # ملف لتجاهل الملفات غير المرغوب فيها من Git
├── 🐍 app.py               # الملف الرئيسي لواجهة Streamlit
├── 🐍 auth_manager.py      # مدير المصادقة مع جوجل (OAuth2)
├── 🐍 database_setup.py    # سكربت لتهيئة قاعدة البيانات لأول مرة
├── 🐍 db_manager.py        # مدير عمليات قاعدة البيانات (قراءة وكتابة)
├── 🐍 main.py              # يحتوي على منطق مزامنة البيانات وحساب الإحصائيات
├── 🐍 pdf_reporter.py      # مسؤول عن إنشاء وتصدير تقارير PDF
└── 📄 requirements.txt     # قائمة المكتبات والحزم المطلوبة
```

## 📊 جولة في المنصة: كيف يعمل الماراثون؟

مساحة مصممة بعناية لتحويل فعل القراءة، الذي غالبًا ما يكون فرديًا، إلى تجربة جماعية غنية بالحماس، ومليئة بالتقدير والنمو المشترك. دعنا نأخذك في جولة داخل هذه المساحة لنرى كيف تم تحقيق ذلك.

### 1\. الصفحة الرئيسية: لوحة التحكم العامة

هذه هي النظرة الشاملة على أداء جميع المتسابقين عبر كل الماراثونات. من خلالها، يمكنك الحصول على صورة كاملة عن النشاط في المجموعة، حيث تعرض:

  - إحصائيات كلية مثل إجمالي عدد الصفحات المقروءة ومجموع ساعات القراءة.
  - قائمة الصدارة (Leaderboard) التي تبيّن أبطال الماراثون الأكثر جمعًا للنقاط على الإطلاق، لتقدير أصحاب النفس الطويل.
  - مؤشرات أداء رئيسية ورسوم بيانية توضح النشاط العام.

![الصفحة الرئيسية: لوحة التحكم العامة](images/image1.png)

### 2\. صفحة تحليلات التحديات

هنا يكمن سحر التنافس\! يمكنك اختيار أي ماراثون قائم أو منتهٍ من القائمة المنسدلة لعرض عالمه الخاص:

  - **إحصائيات التحدي:** ترتيب المشاركين بناءً على النقاط التي جمعوها في هذا الماراثون فقط.
  - **بطاقة القارئ:** عند اختيار اسم أي عضو، تظهر بطاقة أنيقة تلخص جميع إنجازاته داخل هذا التحدي: عدد الكتب التي أنهاها، عدد الصفحات، متوسط القراءة اليومي، والنقاط المكتسبة.

![صفحة تحليلات التحديات](images/image2.png)
![صفحة تحليلات التحديات](images/image3.png)

### 3\. نظام المسابقات والنقاط: فلسفة التحفيز الذكي

هذا هو قلب المشروع النابض، وهو مصمم لتحقيق توازن دقيق بين القراءة الجماعية المنظمة والقراءة الفردية الحرة، لخلق جو حماسي ومرن. يقوم النظام على الأفكار التالية:

  - **حرية الاختيار هي الأساس:** لا يوجد مسار إلزامي. العضو لديه الحرية الكاملة ليختار المسار الذي يناسبه:

    1.  **مسار الكتاب المشترك:** يقرأ الكتاب الذي تم اختياره للتحدي. إنهاؤه يمنحه **دفعة هائلة من النقاط** تقديرًا لالتزامه وتهيئته لجلسة النقاش.
    2.  **مسار الكتاب الحر:** يقرأ أي كتاب آخر من اختياره. هنا، تتضاعف نقاطه بناءً على **وقت القراءة**، لكن نقاط إنهاء الكتاب تكون أقل.

    <!-- end list -->

      - **ويمكن للعضو أن يمشي بالمسارين معًا في وقت واحد، أو حتى يقرأ عدة كتب حرة\! الأمر متروك له ولهمّته.**

  - **منطق النقاط الذكي للموازنة:**

      - **للتشجيع على الالتزام:** نقاط إنهاء **الكتاب المشترك** أعلى بكثير.
      - **لتعزيز المشاركة المجتمعية:** حضور جلسة النقاش الخاصة بالكتاب المشترك يمنح نقاطًا إضافية.
      - **لتشجيع القراءة العميقة:** إضافة **اقتباس** من كتاب يقرأه العضو يمنحه نقاطًا إضافية، مما يحفزه على التفاعل مع النص بشكل أعمق.
      - **لمنع الثغرات:** لا تُحتسب نقاط إنهاء أي كتاب حر إلا إذا استغرقت قراءته **3 ساعات على الأقل**.

  - **دورة حياة التحديات:**

      - **بداية جديدة للجميع:** كل ماراثون يبدأ ونقاطه صفر، مما يعطي فرصة متجددة للمنافسة.
      - **مكافأة الاجتهاد المستمر:** يتم تجميع كل النقاط في لوحة التحكم العامة لتقدير الأبطال الحقيقيين على المدى الطويل.
      - **جوائز وهدايا:** في نهاية كل تحدٍ، يمكن تقديم جوائز لأصحاب المراكز العليا، مثل أن يقوم الفائز باختيار الكتاب المشترك للماراثون القادم.

### 4\. صفحة الإدارة والتحكم (للمشرفين)

هذه الصفحة هي مركز التحكم الشامل الخاص بمدير النظام، حيث يمكنه إدارة كل تفاصيل المشروع بسلاسة عبر عدة تبويبات:

  - **إدارة السجلات 📒:** هذه ميزة قوية للمراجعة والتدقيق. يمكن للمشرف هنا مراجعة جميع سجلات القراءة التي أدخلها الأعضاء، وتعديل أي سجل أو حذفه بسهولة في حال وجود خطأ في الإدخال.
  - **إدارة الأعضاء والكتب 📚:** إضافة أعضاء جدد، تعديل بياناتهم، أو "تعطيل" عضو بشكل مؤقت (يمكن استخدامها كنظام عقوبات). وكذلك إضافة الكتب التي يقرأها الأعضاء.
  - **إدارة التحديات 🎯:** إنشاء تحديات جديدة، تحديد تواريخ بدايتها ونهايتها، وتعيين الكتاب المشترك لكل تحدٍ.
  - **الإعدادات العامة ⚙️:** هنا تكمن مرونة النظام. يمكن للمشرف:
    1.  **تغيير نظام النقاط العام** الذي يُطبّق على كل التحديات.
    2.  **أو، وضع نظام نقاط خاص** لتحدي معين لإثارة الحماس وتنويع أساليب المنافسة.

![صفحة الإدارة والتحكم (للمشرفين)](images/image4.png)
![صفحة الإدارة والتحكم (للمشرفين)](images/image5.png)
![صفحة الإدارة والتحكم (للمشرفين)](images/image6.png)


### 5\. تصدير التقارير الاحترافية (PDF)

بضغطة زر، يمكن تصدير تقرير PDF شامل يلخص نتائج "لوحة التحكم العامة" أو تقرير مخصص لكل تحدٍ على حدة. هذه التقارير:

  - **داعمة للعربية:** مصممة خصيصًا لعرض النصوص والأسماء العربية بشكل صحيح وجميل.
  - **غنية بالمعلومات:** تحتوي على صفحة غلاف، مؤشرات أداء رئيسية، رسوم بيانية، وجداول توضح الترتيب والنتائج.
